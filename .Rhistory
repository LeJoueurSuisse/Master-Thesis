summarize(Total_cons = sum(consumption)) %>%
as_tsibble(index = date, key = Cantons) %>%
filter_index("2019-01-01" ~ "2019-12-31") %>%
model(STL(Total_cons)) %>%
components() %>% autoplot()
# Monthly consumption
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total = sum(consumption)) %>%
as_tsibble(index = month, key = Cantons) %>%
filter_index("2018-01-01" ~ "2022-11-30") %>%
autoplot() +
ggtitle("Monthly consumption per canton since 2018") +
ylab("Ammount in million of kWh") + xlab("Date")
# Monthly consumption
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
filter_index("2018-01-01" ~ "2022-11-30") %>%
model(STL(total_cons))%>%
components() %>% autoplot()
# Monthly consumption
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total = sum(consumption)) %>%
as_tsibble(index = month, key = Cantons) %>%
filter_index("2015-01-01" ~ "2022-11-30") %>%
autoplot() +
ggtitle("Monthly consumption per canton since 2018") +
ylab("Ammount in million of kWh") + xlab("Date")
# Monthly consumption
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total = sum(consumption)) %>%
as_tsibble(index = month, key = Cantons) %>%
filter_index("2018-01-01" ~ "2022-11-30") %>%
autoplot() +
ggtitle("Monthly consumption per canton since 2018") +
ylab("Ammount in million of kWh") + xlab("Date")
# Monthly consumption
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
filter_index("2018-01-01" ~ "2022-11-30") %>%
model(STL(total_cons))%>%
components() %>% autoplot()
View(canton_df_long)
sales_features <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) # %>% features(sales, feature_set(pkgs = "feasts"))
View(sales_features)
sales_features <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
features(total_cons, feature_set(pkgs = "feasts"))
sales_features <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
features(total_cons, feature_set(pkgs = "feasts"))
View(sales_features)
sales_features %>%
select_at(vars(contains("season"), Cantons)) %>%
select(-season_pacf) %>%
mutate(
seasonal_peak_week = glue::glue("Q{seasonal_peak_week+1}"),
seasonal_trough_week = glue::glue("Q{seasonal_trough_week+1}"),
) %>%
GGally::ggpairs(mapping = aes(colour = Cantons))
sales_features %>%
select_at(vars(contains("season"), Cantons)) %>%
select(-season_pacf) %>%
mutate(
seasonal_peak_week = glue::glue("Q{seasonal_peak_week+1}"),
seasonal_trough_week = glue::glue("Q{seasonal_trough_week+1}")
) %>%
GGally::ggpairs(mapping = aes(colour = Cantons))
sales_features <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) # %>%
View(sales_features)
sales_features <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
#group_by(month, Cantons) %>%
#summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) # %>%
sales_features <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
#summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) # %>%
sales_features <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) # %>%
View(sales_features)
sales_features <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
features(total_cons, feature_set(pkgs = "feasts"))
sales_features <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
features(total_cons, feat_stl)
sales_features %>%
ggplot(aes(x = trend_strength, y = seasonal_strength_year, col = Cantons)) +
geom_point(size = 2)
canton_features <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
features(total_cons, feat_stl)
canton_features %>%
ggplot(aes(x = trend_strength, y = seasonal_strength_year, col = Cantons)) +
geom_point(size = 2)
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
features(total_cons, feature_set(pkgs = "feasts")) %>%
select_at(vars(contains("season"), Cantons)) %>%
select(-season_pacf) %>%
mutate(
seasonal_peak_year = glue::glue("Q{seasonal_peak_year+1}"),
seasonal_trough_year = glue::glue("Q{seasonal_trough_year+1}"),
) %>%
GGally::ggpairs(mapping = aes(colour = Cantons))
canton_features <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
features(total_cons, feature_set(pkgs = "feasts"))
canton_features[1:3, ] %>%
select_at(vars(contains("season"), Cantons)) %>%
select(-season_pacf) %>%
mutate(
seasonal_peak_year = glue::glue("Q{seasonal_peak_year+1}"),
seasonal_trough_year = glue::glue("Q{seasonal_trough_year+1}"),
) %>%
GGally::ggpairs(mapping = aes(colour = Cantons))
canton_features[1:3, ]
canton_features[1:5, ] %>%
select_at(vars(contains("season"), Cantons)) %>%
select(-season_pacf) %>%
mutate(
seasonal_peak_year = glue::glue("Q{seasonal_peak_year+1}"),
seasonal_trough_year = glue::glue("Q{seasonal_trough_year+1}"),
) %>%
GGally::ggpairs(mapping = aes(colour = Cantons))
canton_features[1:2, ] %>%
select_at(vars(contains("season"), Cantons)) %>%
select(-season_pacf) %>%
mutate(
seasonal_peak_year = glue::glue("Q{seasonal_peak_year+1}"),
seasonal_trough_year = glue::glue("Q{seasonal_trough_year+1}"),
) %>%
GGally::ggpairs(mapping = aes(colour = Cantons))
canton_features <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
features(total_cons, feature_set(pkgs = "feasts"))
View(canton_features)
test <- canton_features[1:2, ]
View(test)
test <- canton_features[1:2, ] %>%
select_at(vars(contains("season"), Cantons))
View(test)
test <- canton_features[1:2, ] %>%
select_at(vars(contains("season"), Cantons)) %>%
select(-season_pacf)
test <- canton_features[1:2, ] %>%
select_at(vars(contains("season"), Cantons)) %>%
select(-season_pacf) %>%
mutate(
seasonal_peak_year = glue::glue("Q{seasonal_peak_year+1}"),
seasonal_trough_year = glue::glue("Q{seasonal_trough_year+1}"),
)
View(test)
canton_features <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
features(total_cons, feat_stl)
canton_features <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
features(total_cons, feat_stl)
canton_features %>%
ggplot(aes(x = trend_strength, y = seasonal_strength_year, col = Cantons)) +
geom_point(size = 2)
View(canton_features)
canton_features1 <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
features(total_cons, feat_stl)
canton_features %>%
ggplot(aes(x = trend_strength, y = seasonal_strength_year, col = Cantons)) +
geom_point(size = 2)
View(canton_features1)
canton_features %>%
select_at(vars(contains("season"), Cantons)) %>%
select(-season_pacf) %>%
mutate(
seasonal_peak_week = glue::glue("Q{seasonal_peak_week+1}"),
seasonal_trough_week = glue::glue("Q{seasonal_trough_week+1}"),
) %>%
GGally::ggpairs(mapping = aes(colour = Cantons))
canton_features2 <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
features(total_cons, feature_set(pkgs = "feasts"))
canton_features2 %>%
select_at(vars(contains("season"), Cantons)) %>%
select(-season_pacf) %>%
mutate(
seasonal_peak_week = glue::glue("Q{seasonal_peak_week+1}"),
seasonal_trough_week = glue::glue("Q{seasonal_trough_week+1}"),
) %>%
GGally::ggpairs(mapping = aes(colour = Cantons))
canton_features[1:2, ] %>%
select_at(vars(contains("season"), Cantons)) %>%
select(-season_pacf) %>%
mutate(
seasonal_peak_year = glue::glue("Q{seasonal_peak_year+1}"),
seasonal_trough_year = glue::glue("Q{seasonal_trough_year+1}"),
) %>%
GGally::ggpairs(mapping = aes(colour = Cantons))
canton_features2[1:2, ] %>%
select_at(vars(contains("season"), Cantons)) %>%
select(-season_pacf) %>%
mutate(
seasonal_peak_year = glue::glue("Q{seasonal_peak_year+1}"),
seasonal_trough_year = glue::glue("Q{seasonal_trough_year+1}"),
) %>%
GGally::ggpairs(mapping = aes(colour = Cantons))
canton_features2[1:2, ] %>%
select_at(vars(contains("season"), Cantons)) %>%
select(-season_pacf) %>%
mutate(
seasonal_peak_week = glue::glue("Q{seasonal_peak_week+1}"),
seasonal_trough_week = glue::glue("Q{seasonal_trough_week+1}"),
) %>%
GGally::ggpairs(mapping = aes(colour = Cantons))
canton_features2[1:2, ] %>%
select_at(vars(contains("season"), Cantons)) %>%
select(-season_pacf) %>%
mutate(
seasonal_peak_year = glue::glue("Q{seasonal_peak_year+1}"),
seasonal_trough_year = glue::glue("Q{seasonal_trough_year+1}"),
) %>%
GGally::ggpairs(mapping = aes(colour = Cantons))
canton_features2[1:2, ] %>%
select_at(vars(contains("season"), Cantons)) %>%
select(-season_pacf) %>%
mutate(
seasonal_peak_year = glue::glue("Q{seasonal_peak_week+1}"),
seasonal_trough_year = glue::glue("Q{seasonal_trough_week+1}"),
) %>%
GGally::ggpairs(mapping = aes(colour = Cantons))
canton_features2[1:2, ] %>%
select_at(vars(contains("season"), Cantons)) %>%
select(-season_pacf) %>%
mutate(
seasonal_peak_year = glue::glue("Q{seasonal_peak_year+1}"),
seasonal_trough_year = glue::glue("Q{seasonal_trough_year+1}"),
) %>%
GGally::ggpairs(mapping = aes(colour = Cantons))
canton_features2[1:2, ] %>%
select_at(vars(contains("season"), Cantons)) %>%
select(-season_pacf) %>%
mutate(
seasonal_peak_year = glue::glue("Q{seasonal_peak_year+1}"),
seasonal_trough_year = glue::glue("Q{seasonal_trough_year+1}"),
) %>%
GGally::ggpairs(mapping = aes(colour = Cantons))
canton_features2 %>%
select_at(vars(contains("season"), Cantons)) %>%
select(-season_pacf) %>%
mutate(
seasonal_peak_week = glue::glue("Q{seasonal_peak_week+1}"),
seasonal_trough_week = glue::glue("Q{seasonal_trough_week+1}"),
) %>%
GGally::ggpairs(mapping = aes(colour = Cantons))
canton_features2 <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
features(total_cons, feature_set(pkgs = "feasts"))
View(canton_features2)
View(canton_df_long)
canton_features <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
features(total_cons, feat_stl)
canton_features %>%
ggplot(aes(x = trend_strength, y = seasonal_strength_year, col = Cantons)) +
geom_point(size = 2)
# Monthly production
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_prod = sum(production)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
filter_index("2018-01-01" ~ "2022-11-30") %>%
model(STL(total_prod))%>%
components() %>% autoplot()
# Monthly consumption
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
filter_index("2018-01-01" ~ "2022-11-30") %>%
model(STL(total_cons))%>%
components() %>% autoplot()
canton_features %>%
ggplot(aes(x = trend_strength, y = seasonal_strength_year, col = Cantons)) +
geom_point(size = 2)
View(canton_features)
View(canton_features2)
canton_features <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) #%>%
View(canton_features)
canton_features <- canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
features(total_cons, feat_stl)
canton_features %>%
ggplot(aes(x = trend_strength, y = seasonal_strength_year, col = Cantons)) +
geom_point(size = 2)
help(package = "feasts")
canton_df_long %>%
head(10) %>%
kable() %>%
kable_styling()
canton_df_long %>%
group_by(Cantons) %>%
summarize(n = n())
# Daily consumption
canton_df_long %>% group_by(date, Cantons) %>%
summarize(total = sum(consumption)) %>%
as_tsibble(index = date, key = Cantons) %>%
filter_index("2019-01-01" ~ "2019-12-31") %>%
autoplot() +
ggtitle("Daily consumption per canton in 2019") +
ylab("Ammount in million of kWh") + xlab("Date")
# Daily production
canton_df_long %>% group_by(date, Cantons) %>%
summarize(total = sum(production)) %>%
as_tsibble(index = date, key = Cantons) %>%
filter_index("2019-01-01" ~ "2019-12-31") %>%
autoplot() +
ggtitle("Daily production per canton in 2019") +
ylab("Ammount in million of kWh") + xlab("Date")
# Monthly consumption
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total = sum(consumption)) %>%
as_tsibble(index = month, key = Cantons) %>%
filter_index("2018-01-01" ~ "2022-11-30") %>%
autoplot() +
ggtitle("Monthly consumption per canton since 2018") +
ylab("Ammount in million of kWh") + xlab("Date")
# Monthly production
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total = sum(production)) %>%
as_tsibble(index = month, key = Cantons) %>%
filter_index("2018-01-01" ~ "2022-11-30") %>%
autoplot() +
ggtitle("Monthly production per canton since 2018") +
ylab("Ammount in million of kWh") + xlab("Date")
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total_cons = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
filter_index("2018-01-01" ~ "2022-11-30") %>%
model(STL(total_cons))%>%
components() %>% autoplot()
# Monthly consumption
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total = sum(consumption)) %>%
as_tsibble(index = month, key = Cantons) %>%
filter_index("2018-01-01" ~ "2022-11-30") %>%
autoplot() +
ggtitle("Monthly consumption per canton since 2018") +
ylab("Ammount in million of kWh") + xlab("Date")
# Monthly consumption
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total = sum(consumption)) %>%
as_tsibble(index = month, key = Cantons) %>%
filter_index("2018-01-01" ~ "2022-11-30") %>%
autoplot() +
facet_wrap(~Cantons, scales = "free") +
ggtitle("Monthly consumption per canton since 2018") +
ylab("Ammount in million of kWh") + xlab("Date")
# Monthly consumption
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
filter_index("2018-01-01" ~ "2022-11-30") %>%
autoplot() +
facet_wrap(~Cantons, scales = "free") +
ggtitle("Monthly consumption per canton since 2018") +
ylab("Ammount in million of kWh") + xlab("Date")
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total = sum(production)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
filter_index("2018-01-01" ~ "2022-11-30") %>%
autoplot() +
facet_wrap(~Cantons, scales = "free") +
ggtitle("Monthly consumption per canton since 2018") +
ylab("Ammount in million of kWh") + xlab("Date")
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total = sum(production)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
filter_index("2018-01-01" ~ "2022-11-30") %>%
autoplot() +
facet_wrap(~Cantons) +
ggtitle("Monthly consumption per canton since 2018") +
ylab("Ammount in million of kWh") + xlab("Date")
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
filter_index("2018-01-01" ~ "2022-11-30") %>%
autoplot() +
facet_wrap(~Cantons) +
ggtitle("Monthly consumption per canton since 2018") +
ylab("Ammount in million of kWh") + xlab("Date")
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
filter_index("2018-01-01" ~ "2022-11-30") %>%
autoplot() +
facet_wrap(~Cantons) +
ggtitle("Monthly consumption per canton since 2018") +
ylab("Ammount in million of kWh") + xlab("Date")
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total = sum(production)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
filter_index("2018-01-01" ~ "2022-11-30") %>%
autoplot() +
facet_wrap(~Cantons) +
ggtitle("Monthly production per canton since 2018") +
ylab("Ammount in million of kWh") + xlab("Date")
# Monthly consumption
canton_df_long %>%
mutate(month = yearmonth(date), year = year(date)) %>%
group_by(month, Cantons) %>%
summarize(total = sum(consumption)/1000000) %>%
as_tsibble(index = month, key = Cantons) %>%
filter_index("2018-01-01" ~ "2022-11-30") %>%
autoplot() +
facet_wrap(~Cantons, scales = "free") +
ggtitle("Monthly consumption per canton since 2018") +
ylab("Ammount in million of kWh") + xlab("Date")
